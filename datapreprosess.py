# ===================== 1. 国内镜像源配置 - 必须放在最顶部 =====================
import os
os.environ['HF_ENDPOINT'] = 'https://hf-mirror.com'
os.environ['TRANSFORMERS_NO_ADVISORY_WARNINGS'] = '1'
os.environ['TOKENIZERS_PARALLELISM'] = 'false'



# ===================== 3. 加载200组完整平行语料并划分数据集 =====================
import pandas as pd
data = [
    {"spoken": "社保断缴了咋补啊？", "formal": "社保断缴后，申请人可通过政务服务平台提交补缴申请办理相关手续。"},
    {"spoken": "我想办个营业执照，需要带啥东西？", "formal": "申请人办理营业执照时，需携带身份证原件、经营场所证明等相关材料。"},
    {"spoken": "这个补贴啥时候能到账？", "formal": "该类补贴的发放到账时间为申请审核通过后的15个工作日内。"},
    {"spoken": "农村户口能申请低保吗？", "formal": "农村户籍居民满足相关条件的，可依法申请最低生活保障待遇。"},
    {"spoken": "医保异地就医怎么报销？", "formal": "参保人员办理医保异地就医备案后，可按规定享受异地就医报销待遇。"},
    {"spoken": "公积金能取出来买房吗？", "formal": "缴存职工满足购房相关条件的，可申请提取住房公积金用于购房相关支出。"},
    {"spoken": "我社保卡丢了，怎么补办？", "formal": "参保人社保卡遗失后，可前往政务服务大厅或线上平台申请补办社保卡。"},
    {"spoken": "个体户需要交税吗？", "formal": "个体工商户需按照国家税收相关规定，依法履行纳税申报及缴纳义务。"},
    {"spoken": "独生子女补贴怎么申请？", "formal": "符合条件的居民可向户籍所在地街道办事处提交独生子女补贴的申请材料。"},
    {"spoken": "营业执照过期了能续期吗？", "formal": "营业执照有效期届满后，经营者可按规定申请办理营业执照续期手续。"},
    {"spoken": "社保交了10年，能领养老金吗？", "formal": "参保人员累计缴纳养老保险满10年，满足法定退休年龄条件的，可依法申领基本养老金。"},
    {"spoken": "灵活就业人员能交社保吗？", "formal": "灵活就业人员可按规定以个人身份参加职工基本养老保险和职工基本医疗保险。"},
    {"spoken": "社保转移需要什么材料？", "formal": "办理社保转移业务时，申请人需提供身份证原件、社保缴费证明等相关材料。"},
    {"spoken": "医保断缴了还能报销吗？", "formal": "医保断缴期间，参保人员暂无法享受医保报销待遇，补缴后按规定恢复享受。"},
    {"spoken": "我快退休了，社保不够15年咋办？", "formal": "临近退休但养老保险累计缴费不足15年的，可按规定申请延长缴费至满15年。"},
    {"spoken": "公司不给交社保怎么办？", "formal": "用人单位未依法为职工缴纳社会保险的，职工可向劳动保障监察部门投诉举报。"},
    {"spoken": "医保报销比例是多少？", "formal": "职工基本医疗保险报销比例根据就诊医院级别、医疗费用类型等按规定执行，一般为50%-90%。"},
    {"spoken": "新生儿怎么交医保？", "formal": "新生儿可由监护人携带户口簿、出生证明等材料，到户籍所在地医保经办机构办理参保登记。"},
    {"spoken": "社保补缴要交滞纳金吗？", "formal": "逾期补缴社会保险费的，需按规定缴纳一定数额的滞纳金，具体标准按相关规定执行。"},
    {"spoken": "外地社保能转回老家吗？", "formal": "异地缴纳的社会保险可按规定转移至户籍所在地或就业地，缴费年限累计计算。"},
    {"spoken": "个体户营业执照怎么年审？", "formal": "个体工商户需按规定通过国家企业信用信息公示系统完成年度报告公示。"},
    {"spoken": "办营业执照要多少钱？", "formal": "办理营业执照登记业务，按相关规定不收取费用，全程免费办理。"},
    {"spoken": "营业执照能变更法人吗？", "formal": "企业营业执照上的法定代表人信息可按规定向登记机关申请变更登记。"},
    {"spoken": "网店需要办营业执照吗？", "formal": "从事网络经营活动的市场主体，需按规定办理市场主体登记，领取营业执照。"},
    {"spoken": "营业执照丢了怎么补办？", "formal": "营业执照遗失后，经营者需先进行遗失公告，再向登记机关申请补办。"},
    {"spoken": "办营业执照需要多久能下来？", "formal": "营业执照登记业务办理时限一般为3个工作日，符合条件的可当场办结。"},
    {"spoken": "个体户能变更经营范围吗？", "formal": "个体工商户如需变更经营范围，可向登记机关提交相关材料申请变更登记。"},
    {"spoken": "营业执照需要挂在店里吗？", "formal": "企业应将营业执照正本置于经营场所的醒目位置，接受社会监督。"},
    {"spoken": "办营业执照需要本人去吗？", "formal": "办理营业执照可由本人办理，也可委托他人代为办理，委托需提供授权委托书。"},
    {"spoken": "个体户营业执照能转让吗？", "formal": "个体工商户营业执照不得转让，经营者变更需重新办理登记手续。"},
    {"spoken": "营业执照年检逾期了怎么办？", "formal": "营业执照年度报告逾期未公示的，经营者需及时补报公示，并接受相关部门处理。"},
    {"spoken": "个体户营业执照注销需要什么材料？", "formal": "注销个体工商户营业执照需提供身份证、营业执照正副本等相关材料。"},
    {"spoken": "营业执照上的名称能改吗？", "formal": "企业如需变更名称，可向登记机关提交名称变更申请及相关材料办理变更登记。"},
    {"spoken": "低保申请需要什么条件？", "formal": "申请最低生活保障需符合户籍条件、家庭收入低于当地低保标准、家庭财产状况符合规定等要求。"},
    {"spoken": "低保一个月能领多少钱？", "formal": "最低生活保障金发放标准由各地根据经济社会发展水平、物价水平等因素确定，具体金额以当地最新标准为准。"},
    {"spoken": "低保怎么申请？", "formal": "申请最低生活保障需由申请人向户籍所在地街道办事处或乡镇人民政府提出书面申请。"},
    {"spoken": "低保多久审核一次？", "formal": "最低生活保障待遇实行定期复核制度，一般每年复核一次，动态调整保障对象。"},
    {"spoken": "残疾人能优先申请低保吗？", "formal": "持有残疾人证且符合低保条件的残疾人家庭，可按规定优先纳入最低生活保障范围。"},
    {"spoken": "低保户看病有优惠吗？", "formal": "最低生活保障对象可按规定享受医疗救助、门诊慢性病报销等相关医疗优惠政策。"},
    {"spoken": "家庭有车能申请低保吗？", "formal": "家庭拥有非经营性车辆等财产超标的，不符合最低生活保障申请条件。"},
    {"spoken": "低保申请多久能批下来？", "formal": "最低生活保障申请审核审批时限一般为30个工作日，具体以当地经办流程为准。"},
    {"spoken": "低保金是按月发吗？", "formal": "最低生活保障金实行按月发放，通过银行转账方式直接发放至保障对象个人账户。"},
    {"spoken": "城市户口怎么申请低保？", "formal": "城镇户籍居民需向户籍所在地社区居委会提出低保申请，经审核审批后纳入保障范围。"},
    {"spoken": "低保户孩子上学有补贴吗？", "formal": "最低生活保障家庭的在校学生可按规定申请教育救助、助学金等相关补贴。"},
    {"spoken": "低保资格会被取消吗？", "formal": "保障对象家庭收入、财产状况发生变化，不再符合低保条件的，将依法取消其低保资格。"},
    {"spoken": "无子女老人能申请低保吗？", "formal": "无劳动能力、无生活来源、无法定赡养抚养义务人或其法定义务人无履行义务能力的老年人，可申请最低生活保障。"},
    {"spoken": "小微企业能领什么补贴？", "formal": "符合条件的小微企业可按规定申领创业补贴、稳岗补贴、社保补贴等相关扶持补贴。"},
    {"spoken": "创业补贴怎么申请？", "formal": "创业者申请创业补贴需向当地人社部门提交身份证、营业执照、创业计划书等相关材料。"},
    {"spoken": "生育补贴能领多少钱？", "formal": "生育津贴发放标准按职工所在用人单位上年度职工月平均工资计算，具体金额以当地政策为准。"},
    {"spoken": "补贴申请需要什么条件？", "formal": "申请相关补贴需符合户籍、从业状态、经营类型等相关条件，具体以补贴政策要求为准。"},
    {"spoken": "技能培训有补贴吗？", "formal": "符合条件的劳动者参加职业技能培训并取得相应证书的，可按规定申请职业技能培训补贴。"},
    {"spoken": "农村创业有补贴吗？", "formal": "返乡入乡创业人员可按规定享受场地支持、创业补贴、融资贴息等相关创业扶持政策。"},
    {"spoken": "补贴能线上申请吗？", "formal": "相关补贴可通过政务服务APP、网上政务服务平台等线上渠道提交申请，无需现场办理。"},
    {"spoken": "灵活就业补贴怎么领？", "formal": "灵活就业人员符合补贴条件的，需先办理就业登记，再向人社部门申请灵活就业社保补贴。"},
    {"spoken": "残疾人创业有什么补贴？", "formal": "残疾人创业可按规定享受创业补贴、场地租赁补贴、税收减免等相关扶持政策。"},
    {"spoken": "租房补贴怎么申请？", "formal": "符合住房保障条件的申请人，可向户籍所在地或就业地住房保障部门申请租房补贴。"},
    {"spoken": "大学生创业补贴有多少？", "formal": "高校毕业生创业补贴标准由各地自行制定，一般为一次性发放5000-20000元，具体以当地政策为准。"},
    {"spoken": "农业补贴怎么领？", "formal": "符合条件的农业生产经营主体可向当地农业农村部门申请农业生产补贴，补贴通过一卡通直接发放。"},
    {"spoken": "失业补贴怎么申请？", "formal": "失业人员符合失业保险金领取条件的，可通过线上政务平台或失业保险经办机构申请领取。"},
    {"spoken": "公积金怎么交？", "formal": "住房公积金由用人单位和职工个人共同缴存，缴存比例按当地政策及单位规定执行。"},
    {"spoken": "公积金贷款能贷多少？", "formal": "住房公积金贷款额度根据缴存基数、缴存年限、房屋总价等因素综合核定，具体以经办银行审批为准。"},
    {"spoken": "公积金提取需要什么材料？", "formal": "提取住房公积金需提供身份证、相关业务证明材料（如购房合同、租赁合同等）。"},
    {"spoken": "公积金能用来装修吗？", "formal": "缴存职工满足住房装修相关条件的，可按规定申请提取住房公积金用于房屋装修支出。"},
    {"spoken": "公积金账户怎么查询？", "formal": "缴存职工可通过公积金管理中心APP、网上服务平台、自助终端等渠道查询账户信息。"},
    {"spoken": "公积金断缴了有啥影响？", "formal": "住房公积金断缴可能影响公积金贷款申请资格，账户余额仍可按规定提取使用。"},
    {"spoken": "离职后公积金能取出来吗？", "formal": "职工离职后符合提取条件的（如异地就业、退休等），可申请提取住房公积金账户余额。"},
    {"spoken": "公积金能用来还房贷吗？", "formal": "缴存职工可申请办理公积金冲还贷业务，直接用公积金账户余额偿还住房贷款本息。"},
    {"spoken": "公积金缴存比例是多少？", "formal": "住房公积金缴存比例一般为5%-12%，具体比例由用人单位根据自身情况在规定范围内确定。"},
    {"spoken": "公积金能异地贷款买房吗？", "formal": "缴存职工在异地购房的，可按规定向购房地公积金管理中心申请异地公积金贷款。"},
    {"spoken": "公积金能用来租房吗？", "formal": "缴存职工在本市无自有住房且租房居住的，可按规定申请提取住房公积金支付房租。"},
    {"spoken": "公积金提取多久能到账？", "formal": "住房公积金提取申请审核通过后，资金一般在3-5个工作日内到账。"},
    {"spoken": "个人所得税怎么申报？", "formal": "纳税人可通过个人所得税APP、自然人电子税务局等渠道办理个人所得税纳税申报。"},
    {"spoken": "个税专项附加扣除有哪些？", "formal": "个人所得税专项附加扣除包括子女教育、继续教育、大病医疗、住房贷款利息、住房租金、赡养老人等六项。"},
    {"spoken": "工资多少需要交个税？", "formal": "个人综合所得应纳税所得额为年收入减除6万元费用及专项扣除、专项附加扣除等后的余额，余额大于0的需缴纳个人所得税。"},
    {"spoken": "小规模纳税人免税吗？", "formal": "小规模纳税人月销售额未超过10万元（季度30万元）的，可按规定享受增值税免征政策。"},
    {"spoken": "个税汇算清缴怎么操作？", "formal": "纳税人需在每年3月1日至6月30日期间，通过个人所得税APP办理上一年度个人所得税汇算清缴。"},
    {"spoken": "个税能退吗？", "formal": "纳税人在个税汇算清缴时，如已预缴税额大于应纳税额的，可按规定申请退税。"},
    {"spoken": "开公司要交哪些税？", "formal": "企业经营过程中需缴纳的税种包括增值税、企业所得税、城市维护建设税、教育费附加等，具体按经营项目确定。"},
    {"spoken": "电子发票怎么报销？", "formal": "电子发票与纸质发票具有同等法律效力，报销时需提供电子发票版式文件及相关报销凭证。"},
    {"spoken": "个税税率是多少？", "formal": "个人综合所得适用3%-45%的超额累进税率，经营所得适用5%-35%的超额累进税率。"},
    {"spoken": "税务登记怎么办理？", "formal": "企业及个体工商户需在领取营业执照后30日内，向税务机关申请办理税务登记。"},
    {"spoken": "政务大厅周末上班吗？", "formal": "政务服务大厅工作时间一般为周一至周五（法定节假日除外），部分窗口提供延时服务，具体以当地公告为准。"},
    {"spoken": "异地能办身份证吗？", "formal": "居民可在异地公安机关出入境管理部门申请换领、补领居民身份证，需提供相关身份证明材料。"},
    {"spoken": "户口本丢了怎么补办？", "formal": "居民户口簿遗失后，户主可携带身份证到户籍所在地派出所申请补办。"},
    {"spoken": "政务办理能网上预约吗？", "formal": "申请人可通过政务服务网、政务APP等渠道预约政务服务大厅相关业务办理时间。"},
    {"spoken": "临时身份证怎么办理？", "formal": "居民可向户籍所在地派出所或政务服务大厅申请办理临时居民身份证，一般3个工作日内办结。"},
    {"spoken": "不动产权证怎么办理？", "formal": "申请人办理不动产权证需向不动产登记机构提交身份证、购房合同、完税证明等相关材料，审核通过后颁发证书。"},
    {"spoken": "营业执照注销怎么办理？", "formal": "企业注销营业执照需先办理税务注销、清算备案等手续，再向登记机关提交注销申请及相关材料。"},
    {"spoken": "政务服务有咨询电话吗？", "formal": "各地政务服务热线统一为12345，申请人可拨打热线咨询政务办理相关问题。"},
    {"spoken": "出生证明怎么办理？", "formal": "新生儿出生后，父母需携带身份证、户口簿、结婚证等材料，到分娩医院申请办理出生医学证明。"},
    {"spoken": "社保转移能网上办理吗？", "formal": "社保关系转移可通过国家社会保险公共服务平台、政务APP等线上渠道办理，无需现场提交材料。"},
    {"spoken": "婚姻登记需要什么材料？", "formal": "办理结婚登记需提供双方身份证、户口簿、近期免冠合影照片等材料；离婚登记需提供身份证、户口簿、结婚证、离婚协议书等材料。"},
    {"spoken": "居住证怎么办理？", "formal": "非本地户籍居民办理居住证，需向居住地派出所提交身份证、居住证明等材料，审核通过后发放居住证。"},
    {"spoken": "老年证怎么办理？", "formal": "年满60周岁的老年人可携带身份证、户口簿等材料，到户籍所在地或居住地社区居委会申请办理老年证。"},
    {"spoken": "残疾证怎么办理？", "formal": "申请人需向户籍所在地残联提交身份证、户口簿、医疗诊断证明等材料，经评定合格后颁发残疾证。"},
    {"spoken": "大病保险怎么报销？", "formal": "参保人员发生的大病医疗费用，经基本医保报销后，剩余符合条件的费用可按大病保险政策进一步报销。"},
    {"spoken": "健康证怎么办理？", "formal": "从业人员办理健康证需到指定医疗机构进行体检，体检合格后颁发健康证明。"},
    {"spoken": "驾照到期了怎么换证？", "formal": "机动车驾驶证有效期届满前90日内，驾驶人可向车管所提交身份证、体检证明等材料申请换证。"},
    {"spoken": "护照怎么办理？", "formal": "申请人办理护照需向公安机关出入境管理部门提交身份证、照片等材料，审核通过后颁发护照。"},
    {"spoken": "港澳通行证怎么办理？", "formal": "申请人办理港澳通行证需向公安机关出入境管理部门提交身份证、照片等材料，按规定办理签注。"},
    {"spoken": "社保卡怎么激活？", "formal": "参保人可携带社保卡和身份证到社保卡合作银行网点，或通过自助终端办理社保卡激活手续。"},
    {"spoken": "医保电子凭证怎么激活？", "formal": "参保人员可通过国家医保服务APP、微信、支付宝等渠道激活医保电子凭证，用于就医结算。"},
    {"spoken": "租房备案怎么办理？", "formal": "房屋租赁双方需携带身份证、租赁合同、房产证等材料，到房屋所在地街道办事处办理租赁备案手续。"},
    {"spoken": "公积金卡丢了怎么补办？", "formal": "缴存职工公积金卡遗失后，可到发卡银行申请挂失补办，补办后需到公积金管理中心关联账户。"},
    {"spoken": "就业失业登记证怎么办理？", "formal": "失业人员可向户籍所在地或就业地人社部门提交身份证、解除劳动合同证明等材料，申请办理就业失业登记证。"},
    {"spoken": "退休手续怎么办理？", "formal": "达到法定退休年龄的职工，由用人单位或本人向社保经办机构提交退休申请及相关材料，办理退休手续。"},
    {"spoken": "生育保险怎么报销？", "formal": "参保女职工生育后，可向医保经办机构提交身份证、生育证明、医疗费用票据等材料，申请生育保险报销。"},
    {"spoken": "工伤保险怎么申请？", "formal": "职工发生工伤后，用人单位需在30日内向社保经办机构申请工伤认定，认定后按规定享受工伤保险待遇。"},
    {"spoken": "失业保险金能领多久？", "formal": "失业保险金领取期限根据缴费年限确定，最长不超过24个月，具体按相关规定执行。"},
    {"spoken": "公证怎么办理？", "formal": "申请人需向公证处提交身份证、相关证明材料等，经公证员审核后办理公证手续。"},
    {"spoken": "法律援助怎么申请？", "formal": "符合法律援助条件的申请人，可向当地法律援助中心提交申请及相关证明材料，获得免费法律服务。"},
    {"spoken": "信访怎么反映问题？", "formal": "公民可通过信访部门窗口、信访网站、信访热线等渠道，依法有序反映合理诉求。"},
    {"spoken": "社保查询怎么查？", "formal": "参保人员可通过政务服务平台、社保经办机构窗口、自助终端等渠道查询社保缴费信息。"},
    {"spoken": "失业了社保怎么交？", "formal": "失业人员可凭失业证明以灵活就业人员身份继续缴纳养老保险和医疗保险。"},
    {"spoken": "社保交满15年就不用交了吗？", "formal": "养老保险累计缴费满15年是领取养老金的最低条件，未达到退休年龄的可继续缴纳，缴费年限越长待遇越高。"},
    {"spoken": "医保门诊能报销吗？", "formal": "职工基本医疗保险参保人员在定点医疗机构发生的门诊医疗费用，符合规定的可按比例报销。"},
    {"spoken": "社保转移需要多久？", "formal": "社会保险关系转移业务办理时限一般为15-30个工作日，具体以经办机构实际办理情况为准。"},
    {"spoken": "退休后社保能异地领取吗？", "formal": "退休人员可按规定在异地领取基本养老金，无需返回参保地，资金直接发放至指定银行账户。"},
    {"spoken": "分公司怎么办营业执照？", "formal": "设立分公司需向分公司所在地登记机关提交总公司营业执照、分公司设立登记申请书等材料。"},
    {"spoken": "营业执照上的地址能改吗？", "formal": "企业经营场所变更的，需向登记机关申请办理营业执照地址变更登记。"},
    {"spoken": "电子商务营业执照怎么办理？", "formal": "从事电子商务经营的市场主体，可通过线上政务平台或登记机关窗口申请办理营业执照。"},
    {"spoken": "办营业执照需要提前准备什么？", "formal": "办理营业执照前，需提前准备身份证、经营场所证明、公司章程（企业）等相关材料。"},
    {"spoken": "办营业执照需要验资吗？", "formal": "当前设立企业一般无需提供验资报告，实行注册资本认缴登记制。"},
    {"spoken": "营业执照的经营范围怎么写？", "formal": "营业执照经营范围应按国民经济行业分类标准规范填写，涵盖企业实际经营项目。"},
    {"spoken": "异地能办营业执照吗？", "formal": "经营者需向经营场所所在地登记机关申请办理营业执照，异地经营需按规定设立分支机构。"},
    {"spoken": "营业执照副本有什么用？", "formal": "营业执照副本可作为企业从事经营活动的合法凭证，用于签订合同、办理相关业务等。"},
    {"spoken": "个体户营业执照有效期是多久？", "formal": "个体工商户营业执照长期有效，除非被依法吊销、注销或申请变更登记。"},
    {"spoken": "低保申请需要提交什么材料？", "formal": "申请最低生活保障需提交身份证、户口簿、家庭收入证明、财产状况证明等相关材料。"},
    {"spoken": "低保户能享受廉租房吗？", "formal": "最低生活保障家庭符合住房保障条件的，可按规定申请廉租房、公租房等住房保障。"},
    {"spoken": "临时困难能申请低保吗？", "formal": "因突发事件导致家庭临时困难的，可申请临时救助，不符合低保条件的不纳入低保范围。"},
    {"spoken": "低保金能补发吗？", "formal": "经审核确认符合低保条件但未及时发放保障金的，可按规定补发相应期限的低保金。"},
    {"spoken": "共同生活的家庭成员怎么认定？", "formal": "最低生活保障共同生活家庭成员按《社会救助暂行办法》相关规定进行认定，包括配偶、父母、子女等。"},
    {"spoken": "低保申请被拒了怎么办？", "formal": "低保申请未通过的，申请人可向审核机关申请复核，或向上级民政部门申请行政复议。"},
    {"spoken": "补贴申请多久能审核通过？", "formal": "补贴申请审核时限一般为10-15个工作日，审核结果将通过短信或政务平台告知申请人。"},
    {"spoken": "补贴发放失败怎么办？", "formal": "补贴发放失败的，申请人可检查银行账户信息是否正确，或联系补贴发放部门核实处理。"},
    {"spoken": "补贴需要交个人所得税吗？", "formal": "按国家规定发放的专项补贴、救助金等，符合条件的可免征个人所得税。"},
    {"spoken": "补贴申请材料不全怎么办？", "formal": "补贴申请材料不全的，申请人需按审核部门要求补充相关材料后，重新提交申请。"},
    {"spoken": "补贴能重复申请吗？", "formal": "同一申请人同一事项不得重复申请补贴，符合多项补贴条件的可按规定分别申请。"},
    {"spoken": "补贴政策什么时候截止？", "formal": "相关补贴政策实施期限以政府发布的政策文件为准，截止前提交的申请按规定审核发放。"},
    {"spoken": "公积金贷款年限最长是多久？", "formal": "住房公积金贷款最长期限一般不超过30年，具体以当地公积金管理中心规定为准。"},
    {"spoken": "公积金账户余额能继承吗？", "formal": "职工死亡后，住房公积金账户余额可由继承人或受遗赠人按规定提取继承。"},
    {"spoken": "公积金贷款利息是多少？", "formal": "住房公积金贷款利率按中国人民银行公布的基准利率执行，低于商业住房贷款利率。"},
    {"spoken": "公积金能补缴吗？", "formal": "用人单位未按时缴存住房公积金的，可按规定为职工补缴欠缴的公积金。"},
    {"spoken": "个人能交公积金吗？", "formal": "灵活就业人员部分地区可按规定以个人身份缴存住房公积金，具体以当地政策为准。"},
    {"spoken": "公积金贷款提前还款有违约金吗？", "formal": "住房公积金贷款提前还款一般不收取违约金，具体以贷款合同及当地规定为准。"},
    {"spoken": "发票丢了怎么办？", "formal": "发票遗失后，购票方需按规定向税务机关报告，并登报声明作废，再按相关流程处理。"},
    {"spoken": "企业所得税怎么交？", "formal": "企业所得税按纳税年度计算，分月或分季预缴，年度终了后5个月内办理汇算清缴。"},
    {"spoken": "个税专项附加扣除怎么申报？", "formal": "纳税人可通过个人所得税APP填写专项附加扣除信息，提交后由税务机关审核确认。"},
    {"spoken": "偷税漏税会有什么后果？", "formal": "纳税人偷税漏税的，税务机关将追缴其不缴或者少缴的税款、滞纳金，并处相应罚款；构成犯罪的，依法追究刑事责任。"},
    {"spoken": "小规模纳税人税率是多少？", "formal": "增值税小规模纳税人适用3%的征收率，特殊业务按相关规定执行。"},
    {"spoken": "个税扣除赡养老人需要什么证明？", "formal": "申报赡养老人专项附加扣除无需提供证明材料，纳税人需留存相关信息备查。"},
    {"spoken": "发票怎么开？", "formal": "企业可通过增值税发票管理系统开具发票，个人可向税务机关申请代开发票。"},
    {"spoken": "免税政策有哪些？", "formal": "国家针对不同行业、不同群体制定了多项税收优惠政策，具体可通过税务机关官网查询。"},
    {"spoken": "税务申报逾期了怎么办？", "formal": "税务申报逾期的，纳税人需及时补报，并按规定缴纳滞纳金；情节严重的，将面临罚款。"},
    {"spoken": "政务办理需要本人去吗？", "formal": "部分政务服务事项可委托他人代办，需提供授权委托书、双方身份证及相关材料；部分事项需本人到场办理。"},
    {"spoken": "政务办理多久能办好？", "formal": "各类政务服务事项办理时限不同，一般为3-15个工作日，具体以事项办理指南为准。"},
    {"spoken": "政务办理可以加急吗？", "formal": "符合加急办理条件的政务服务事项（如紧急出国、就医等），申请人可申请加急办理，具体按规定执行。"},
    {"spoken": "政务办理材料可以邮寄吗？", "formal": "部分政务服务事项支持邮寄办理，申请人可将相关材料邮寄至经办机构，办理结果通过邮寄送达。"},
    {"spoken": "政务办理收费吗？", "formal": "行政许可、公共服务等政务事项办理，按规定不收取费用，严禁违规收费。"},
    {"spoken": "政务办理结果怎么查询？", "formal": "申请人可通过政务服务网、APP等渠道，输入办理事项编号查询政务办理进度及结果。"},
    {"spoken": "疫苗接种需要预约吗？", "formal": "新冠疫苗等疫苗接种可通过社区卫生服务中心、疫苗接种点或线上预约平台预约接种时间。"},
    {"spoken": "教师资格证怎么考？", "formal": "报考教师资格证需符合学历、户籍等条件，通过国家教师资格考试（笔试+面试）后，申请认定教师资格。"},
    {"spoken": "燃气费怎么交？", "formal": "用户可通过燃气公司APP、微信、支付宝、银行代扣等渠道缴纳燃气费用。"},
    {"spoken": "电费能网上交吗？", "formal": "电力用户可通过国家电网APP、微信、支付宝等线上渠道缴纳电费，实时到账。"},
    {"spoken": "水费怎么查询？", "formal": "用户可通过水务公司官网、APP、微信公众号等渠道查询水费账单及缴费情况。"},
    {"spoken": "暖气费怎么交？", "formal": "供暖用户可通过供暖公司线下营业厅、线上缴费平台等渠道缴纳供暖费用。"},
    {"spoken": "宽带怎么办理？", "formal": "用户可到电信、联通、移动等运营商营业厅，或通过线上渠道申请办理宽带业务。"},
    {"spoken": "手机号过户怎么办理？", "formal": "手机号过户需双方携带身份证到运营商营业厅办理，签订过户协议。"},
    {"spoken": "学生证怎么补办？", "formal": "学生学生证遗失后，需向学校学生管理部门提交补办申请，经审核后补发学生证。"},
    {"spoken": "档案怎么转移？", "formal": "个人档案转移需通过机要渠道或档案管理机构专用渠道办理，严禁个人自带档案。"},
    {"spoken": "职业资格证书怎么查询？", "formal": "用户可通过国家职业资格证书全国联网查询系统，输入证书编号查询职业资格证书真伪。"},
    {"spoken": "社保个人账户里的钱能取吗？", "formal": "养老保险个人账户资金一般不可提前支取，符合法定条件的可按规定领取。"},
    {"spoken": "社保基数调高调低有啥影响？", "formal": "社保缴费基数高低直接影响个人账户储存额及未来养老金领取金额，基数越高，相关待遇越高。"},
    {"spoken": "社保停交后多久会失效？", "formal": "养老保险停交后个人账户保留，缴费年限累计计算；医疗保险停交超过3个月可能影响报销资格。"},
    {"spoken": "医保个人账户能给家人用吗？", "formal": "部分地区已实现医保个人账户家庭共济，参保人员可按规定为家庭成员支付相关医疗费用。"},
    {"spoken": "无地址能办营业执照吗？", "formal": "办理营业执照需提供合法有效的经营场所证明，无实际经营场所的无法办理。"},
    {"spoken": "公积金贷款怎么申请？", "formal": "缴存职工申请住房公积金贷款，需向公积金管理中心提交贷款申请及相关证明材料。"},
    {"spoken": "税务登记怎么办理？", "formal": "企业及个体工商户需在领取营业执照后30日内，向税务机关申请办理税务登记。"},
    {"spoken": "社保卡怎么激活？", "formal": "参保人可携带社保卡和身份证到社保卡合作银行网点，或通过自助终端办理社保卡激活手续。"},
    {"spoken": "医保电子凭证怎么激活？", "formal": "参保人员可通过国家医保服务APP、微信、支付宝等渠道激活医保电子凭证，用于就医结算。"},
    {"spoken": "租房备案怎么办理？", "formal": "房屋租赁双方需携带身份证、租赁合同、房产证等材料，到房屋所在地街道办事处办理租赁备案手续。"},
    {"spoken": "公积金卡丢了怎么补办？", "formal": "缴存职工公积金卡遗失后，可到发卡银行申请挂失补办，补办后需到公积金管理中心关联账户。"},
    {"spoken": "就业失业登记证怎么办理？", "formal": "失业人员可向户籍所在地或就业地人社部门提交身份证、解除劳动合同证明等材料，申请办理就业失业登记证。"},
    {"spoken": "退休手续怎么办理？", "formal": "达到法定退休年龄的职工，由用人单位或本人向社保经办机构提交退休申请及相关材料，办理退休手续。"},
    {"spoken": "生育保险怎么报销？", "formal": "参保女职工生育后，可向医保经办机构提交身份证、生育证明、医疗费用票据等材料，申请生育保险报销。"},
    {"spoken": "工伤保险怎么申请？", "formal": "职工发生工伤后，用人单位需在30日内向社保经办机构申请工伤认定，认定后按规定享受工伤保险待遇。"},
    {"spoken": "失业保险金能领多久？", "formal": "失业保险金领取期限根据缴费年限确定，最长不超过24个月，具体按相关规定执行。"},
    {"spoken": "公证怎么办理？", "formal": "申请人需向公证处提交身份证、相关证明材料等，经公证员审核后办理公证手续。"},
    {"spoken": "法律援助怎么申请？", "formal": "符合法律援助条件的申请人，可向当地法律援助中心提交申请及相关证明材料，获得免费法律服务。"},
    {"spoken": "信访怎么反映问题？", "formal": "公民可通过信访部门窗口、信访网站、信访热线等渠道，依法有序反映合理诉求。"},
    {"spoken": "社保查询怎么查？", "formal": "参保人员可通过政务服务平台、社保经办机构窗口、自助终端等渠道查询社保缴费信息。"},
    {"spoken": "失业了社保怎么交？", "formal": "失业人员可凭失业证明以灵活就业人员身份继续缴纳养老保险和医疗保险。"},
    {"spoken": "社保交满15年就不用交了吗？", "formal": "养老保险累计缴费满15年是领取养老金的最低条件，未达到退休年龄的可继续缴纳，缴费年限越长待遇越高。"},
    {"spoken": "医保门诊能报销吗？", "formal": "职工基本医疗保险参保人员在定点医疗机构发生的门诊医疗费用，符合规定的可按比例报销。"},
    {"spoken": "社保转移需要多久？", "formal": "社会保险关系转移业务办理时限一般为15-30个工作日，具体以经办机构实际办理情况为准。"},
    {"spoken": "退休后社保能异地领取吗？", "formal": "退休人员可按规定在异地领取基本养老金，无需返回参保地，资金直接发放至指定银行账户。"},
    {"spoken": "分公司怎么办营业执照？", "formal": "设立分公司需向分公司所在地登记机关提交总公司营业执照、分公司设立登记申请书等材料。"},
    {"spoken": "营业执照上的地址能改吗？", "formal": "企业经营场所变更的，需向登记机关申请办理营业执照地址变更登记。"},
    {"spoken": "电子商务营业执照怎么办理？", "formal": "从事电子商务经营的市场主体，可通过线上政务平台或登记机关窗口申请办理营业执照。"},
    {"spoken": "办营业执照需要提前准备什么？", "formal": "办理营业执照前，需提前准备身份证、经营场所证明、公司章程（企业）等相关材料。"},
    {"spoken": "办营业执照需要验资吗？", "formal": "当前设立企业一般无需提供验资报告，实行注册资本认缴登记制。"},
    {"spoken": "营业执照的经营范围怎么写？", "formal": "营业执照经营范围应按国民经济行业分类标准规范填写，涵盖企业实际经营项目。"},
    {"spoken": "异地能办营业执照吗？", "formal": "经营者需向经营场所所在地登记机关申请办理营业执照，异地经营需按规定设立分支机构。"},
    {"spoken": "营业执照副本有什么用？", "formal": "营业执照副本可作为企业从事经营活动的合法凭证，用于签订合同、办理相关业务等。"},
    {"spoken": "个体户营业执照有效期是多久？", "formal": "个体工商户营业执照长期有效，除非被依法吊销、注销或申请变更登记。"},
    {"spoken": "低保申请需要提交什么材料？", "formal": "申请最低生活保障需提交身份证、户口簿、家庭收入证明、财产状况证明等相关材料。"},
    {"spoken": "低保户能享受廉租房吗？", "formal": "最低生活保障家庭符合住房保障条件的，可按规定申请廉租房、公租房等住房保障。"},
    {"spoken": "临时困难能申请低保吗？", "formal": "因突发事件导致家庭临时困难的，可申请临时救助，不符合低保条件的不纳入低保范围。"},
    {"spoken": "低保金能补发吗？", "formal": "经审核确认符合低保条件但未及时发放保障金的，可按规定补发相应期限的低保金。"},
    {"spoken": "共同生活的家庭成员怎么认定？", "formal": "最低生活保障共同生活家庭成员按《社会救助暂行办法》相关规定进行认定，包括配偶、父母、子女等。"},
    {"spoken": "低保申请被拒了怎么办？", "formal": "低保申请未通过的，申请人可向审核机关申请复核，或向上级民政部门申请行政复议。"},
    {"spoken": "补贴申请多久能审核通过？", "formal": "补贴申请审核时限一般为10-15个工作日，审核结果将通过短信或政务平台告知申请人。"},
    {"spoken": "补贴发放失败怎么办？", "formal": "补贴发放失败的，申请人可检查银行账户信息是否正确，或联系补贴发放部门核实处理。"},
    {"spoken": "补贴需要交个人所得税吗？", "formal": "按国家规定发放的专项补贴、救助金等，符合条件的可免征个人所得税。"},
    {"spoken": "补贴申请材料不全怎么办？", "formal": "补贴申请材料不全的，申请人需按审核部门要求补充相关材料后，重新提交申请。"},
    {"spoken": "补贴能重复申请吗？", "formal": "同一申请人同一事项不得重复申请补贴，符合多项补贴条件的可按规定分别申请。"},
    {"spoken": "补贴政策什么时候截止？", "formal": "相关补贴政策实施期限以政府发布的政策文件为准，截止前提交的申请按规定审核发放。"},
    {"spoken": "公积金贷款年限最长是多久？", "formal": "住房公积金贷款最长期限一般不超过30年，具体以当地公积金管理中心规定为准。"},
    {"spoken": "公积金账户余额能继承吗？", "formal": "职工死亡后，住房公积金账户余额可由继承人或受遗赠人按规定提取继承。"},
    {"spoken": "公积金贷款利息是多少？", "formal": "住房公积金贷款利率按中国人民银行公布的基准利率执行，低于商业住房贷款利率。"},
    {"spoken": "公积金能补缴吗？", "formal": "用人单位未按时缴存住房公积金的，可按规定为职工补缴欠缴的公积金。"},
    {"spoken": "个人能交公积金吗？", "formal": "灵活就业人员部分地区可按规定以个人身份缴存住房公积金，具体以当地政策为准。"},
    {"spoken": "公积金贷款提前还款有违约金吗？", "formal": "住房公积金贷款提前还款一般不收取违约金，具体以贷款合同及当地规定为准。"},
    {"spoken": "发票丢了怎么办？", "formal": "发票遗失后，购票方需按规定向税务机关报告，并登报声明作废，再按相关流程处理。"},
    {"spoken": "企业所得税怎么交？", "formal": "企业所得税按纳税年度计算，分月或分季预缴，年度终了后5个月内办理汇算清缴。"},
    {"spoken": "个税专项附加扣除怎么申报？", "formal": "纳税人可通过个人所得税APP填写专项附加扣除信息，提交后由税务机关审核确认。"},
    {"spoken": "偷税漏税会有什么后果？", "formal": "纳税人偷税漏税的，税务机关将追缴其不缴或者少缴的税款、滞纳金，并处相应罚款；构成犯罪的，依法追究刑事责任。"},
    {"spoken": "小规模纳税人税率是多少？", "formal": "增值税小规模纳税人适用3%的征收率，特殊业务按相关规定执行。"},
    {"spoken": "个税扣除赡养老人需要什么证明？", "formal": "申报赡养老人专项附加扣除无需提供证明材料，纳税人需留存相关信息备查。"},
    {"spoken": "发票怎么开？", "formal": "企业可通过增值税发票管理系统开具发票，个人可向税务机关申请代开发票。"},
    {"spoken": "免税政策有哪些？", "formal": "国家针对不同行业、不同群体制定了多项税收优惠政策，具体可通过税务机关官网查询。"},
    {"spoken": "税务申报逾期了怎么办？", "formal": "税务申报逾期的，纳税人需及时补报，并按规定缴纳滞纳金；情节严重的，将面临罚款。"},
    {"spoken": "政务办理需要本人去吗？", "formal": "部分政务服务事项可委托他人代办，需提供授权委托书、双方身份证及相关材料；部分事项需本人到场办理。"},
    {"spoken": "政务办理多久能办好？", "formal": "各类政务服务事项办理时限不同，一般为3-15个工作日，具体以事项办理指南为准。"},
    {"spoken": "政务办理可以加急吗？", "formal": "符合加急办理条件的政务服务事项（如紧急出国、就医等），申请人可申请加急办理，具体按规定执行。"},
    {"spoken": "政务办理材料可以邮寄吗？", "formal": "部分政务服务事项支持邮寄办理，申请人可将相关材料邮寄至经办机构，办理结果通过邮寄送达。"},
    {"spoken": "政务办理收费吗？", "formal": "行政许可、公共服务等政务事项办理，按规定不收取费用，严禁违规收费。"},
    {"spoken": "政务办理结果怎么查询？", "formal": "申请人可通过政务服务网、APP等渠道，输入办理事项编号查询政务办理进度及结果。"},
    {"spoken": "疫苗接种需要预约吗？", "formal": "新冠疫苗等疫苗接种可通过社区卫生服务中心、疫苗接种点或线上预约平台预约接种时间。"},
    {"spoken": "教师资格证怎么考？", "formal": "报考教师资格证需符合学历、户籍等条件，通过国家教师资格考试（笔试+面试）后，申请认定教师资格。"},
    {"spoken": "燃气费怎么交？", "formal": "用户可通过燃气公司APP、微信、支付宝、银行代扣等渠道缴纳燃气费用。"},
    {"spoken": "电费能网上交吗？", "formal": "电力用户可通过国家电网APP、微信、支付宝等线上渠道缴纳电费，实时到账。"},
    {"spoken": "水费怎么查询？", "formal": "用户可通过水务公司官网、APP、微信公众号等渠道查询水费账单及缴费情况。"},
    {"spoken": "暖气费怎么交？", "formal": "供暖用户可通过供暖公司线下营业厅、线上缴费平台等渠道缴纳供暖费用。"},
    {"spoken": "宽带怎么办理？", "formal": "用户可到电信、联通、移动等运营商营业厅，或通过线上渠道申请办理宽带业务。"},
    {"spoken": "手机号过户怎么办理？", "formal": "手机号过户需双方携带身份证到运营商营业厅办理，签订过户协议。"},
    {"spoken": "学生证怎么补办？", "formal": "学生学生证遗失后，需向学校学生管理部门提交补办申请，经审核后补发学生证。"},
    {"spoken": "档案怎么转移？", "formal": "个人档案转移需通过机要渠道或档案管理机构专用渠道办理，严禁个人自带档案。"},
    {"spoken": "职业资格证书怎么查询？", "formal": "用户可通过国家职业资格证书全国联网查询系统，输入证书编号查询职业资格证书真伪。"}
]
df = pd.DataFrame(data)
train_df = df[:150]
val_df = df[150:180]
test_df = df[180:]
train_df.to_csv("train_data.csv", index=False, encoding="utf-8")
val_df.to_csv("val_data.csv", index=False, encoding="utf-8")
test_df.to_csv("test_data.csv", index=False, encoding="utf-8")
print("✅ 200组数据准备完成！训练集150组，验证集30组，测试集20组")

# ===================== 4. 数据预处理 =====================
import jieba
from transformers import BartTokenizer, BertTokenizer  # 替换原有的BartTokenizer
from transformers import BartForConditionalGeneration  # 模型仍用BartForConditionalGeneration

tokenizer = BertTokenizer.from_pretrained("fnlp/bart-base-chinese")
def preprocess_text(text):
    text = text.strip().replace(" ", "").replace("\n", "").replace("呢", "").replace("啊", "").replace("吧", "")
    return text
def load_data(file_path):
    df = pd.read_csv(file_path, encoding="utf-8")
    spoken_texts = [preprocess_text(x) for x in df["spoken"].tolist()]
    formal_texts = [preprocess_text(x) for x in df["formal"].tolist()]
    return spoken_texts, formal_texts
def encode_data(spoken_list, formal_list, tokenizer, max_len=64):
    inputs = tokenizer(spoken_list, truncation=True, padding="max_length", max_length=max_len, return_tensors="pt")
    labels = tokenizer(formal_list, truncation=True, padding="max_length", max_length=max_len, return_tensors="pt")["input_ids"]
    return inputs, labels
train_spoken, train_formal = load_data("train_data.csv")
val_spoken, val_formal = load_data("val_data.csv")
test_spoken, test_formal = load_data("test_data.csv")
train_inputs, train_labels = encode_data(train_spoken, train_formal, tokenizer)
val_inputs, val_labels = encode_data(val_spoken, val_formal, tokenizer)
print("✅ 数据预处理完成！")

# ===================== 5. 模型训练 =====================
import torch
# 单独导入模型
from transformers import BartForConditionalGeneration
# 从optimization子模块导入优化器和调度器
from transformers.optimization import get_scheduler
from torch.optim import AdamW
from tqdm.auto import tqdm
device = "cuda" if torch.cuda.is_available() else "cpu"
model_name = "fnlp/bart-base-chinese"
epochs = 15
lr = 2e-5
model = BartForConditionalGeneration.from_pretrained(model_name).to(device)
optimizer = AdamW(model.parameters(), lr=lr)
num_training_steps = epochs * len(train_spoken)
lr_scheduler = get_scheduler(name="linear", optimizer=optimizer, num_warmup_steps=0, num_training_steps=num_training_steps)
# 修改训练函数，添加Batch Size参数（例如Batch Size=4）
def train_epoch(model, inputs, labels, optimizer, scheduler, device, batch_size=4):
    model.train()
    total_loss = 0
    # 按Batch Size拆分数据
    for i in range(0, len(inputs["input_ids"]), batch_size):
        # 取当前Batch的数据
        input_ids = inputs["input_ids"][i:i+batch_size].to(device)
        attention_mask = inputs["attention_mask"][i:i+batch_size].to(device)
        batch_labels = labels[i:i+batch_size].to(device)
        
        # 前向传播+计算损失
        outputs = model(input_ids=input_ids, attention_mask=attention_mask, labels=batch_labels)
        loss = outputs.loss
        total_loss += loss.item() * len(input_ids)  # 按Batch大小加权
        
        # 反向传播
        loss.backward()
        optimizer.step()
        scheduler.step()
        optimizer.zero_grad()
    
    return total_loss / len(inputs["input_ids"])  # 平均损失

# 验证函数做同样修改
def val_epoch(model, inputs, labels, device, batch_size=4):
    model.eval()
    total_loss = 0
    with torch.no_grad():
        for i in range(0, len(inputs["input_ids"]), batch_size):
            input_ids = inputs["input_ids"][i:i+batch_size].to(device)
            attention_mask = inputs["attention_mask"][i:i+batch_size].to(device)
            batch_labels = labels[i:i+batch_size].to(device)
            
            outputs = model(input_ids=input_ids, attention_mask=attention_mask, labels=batch_labels)
            loss = outputs.loss
            total_loss += loss.item() * len(input_ids)
    
    return total_loss / len(inputs["input_ids"])

# 调用训练/验证函数时传入batch_size
train_loss = train_epoch(model, train_inputs, train_labels, optimizer, lr_scheduler, device, batch_size=4)
val_loss = val_epoch(model, val_inputs, val_labels, device, batch_size=4)
progress_bar = tqdm(range(num_training_steps))
best_val_loss = float("inf")
for epoch in range(epochs):
    train_loss = train_epoch(model, train_inputs, train_labels, optimizer, lr_scheduler, device, batch_size=4)
    val_loss = val_epoch(model, val_inputs, val_labels, device, batch_size=4)
    print(f"Epoch {epoch+1}/{epochs} | Train Loss: {train_loss:.4f} | Val Loss: {val_loss:.4f}")
    progress_bar.update(len(train_spoken))
    if val_loss < best_val_loss:
        best_val_loss = val_loss
        model.save_pretrained("./best_bart_style_transfer")
        tokenizer.save_pretrained("./best_bart_style_transfer")
        print(f"✅ 保存最优模型，当前最优验证损失：{best_val_loss:.4f}")
print("🎉 模型训练完成！最优模型已保存")

# ===================== 6. 模型测试+后处理（核心创新点） =====================
model_path = "./best_bart_style_transfer"
model = BartForConditionalGeneration.from_pretrained(model_path)
tokenizer = BertTokenizer.from_pretrained(model_path)
model = model.to(device)
model.eval()
def spoken2formal(spoken_text, max_len=64):
    inputs = tokenizer(spoken_text, truncation=True, padding="max_length", max_length=max_len, return_tensors="pt")
    input_ids = inputs["input_ids"].to(device)
    attention_mask = inputs["attention_mask"].to(device)
    with torch.no_grad():
        outputs = model.generate(input_ids=input_ids, attention_mask=attention_mask, max_length=max_len, num_beams=4, repetition_penalty=2.5, length_penalty=1.0, early_stopping=True)
    formal_text = tokenizer.decode(outputs[0], skip_special_tokens=True)
    return formal_text
# 后处理优化（你的创新点）
def post_process(formal_text):
    replace_dict = {
        "我": "申请人", "咋": "如何", "啥": "什么", "能": "可", "要": "需", "带": "携带",
        "办": "办理", "拿": "提交", "给": "发放", "弄": "办理", "行": "可行", "好的": "符合要求",
        "可以": "可依法", "不知道": "暂未了解到", "想": "申请"
    }
    for k, v in replace_dict.items():
        formal_text = formal_text.replace(k, v)
    formal_text = formal_text.strip().replace("。。", "。").replace("，，", "，")
    if not formal_text.endswith("。"):
        formal_text += "。"
    return formal_text
# 测试交互
print("\n===== 口语→政务正式语 风格迁移模型 测试开始 =====")
print("输入 'exit' 可退出测试\n")
while True:
    spoken_input = input("请输入口语化政务问题：")
    if spoken_input == "exit":
        print("测试结束，谢谢使用！")
        break
    formal_output = spoken2formal(spoken_input)
    final_output = post_process(formal_output)
    print(f"✅ 口语输入：{spoken_input}")
    print(f"✅ 正式输出：{final_output}\n")